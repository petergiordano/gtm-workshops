<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activity 1: Competitive Field Snapshot</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&family=Raleway:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Open Sans', 'Raleway', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background-color: #fafafa;
        }
        .force-box.selected {
            border: 3px solid #FF7F00;
            box-shadow: 0 0 0 2px rgba(255, 127, 0, 0.2);
        }
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="application/json" id="testData">
    {
        "customers": "Mid-market to Enterprise tech companies (e.g., SaaS, e-commerce) with complex, API-driven architectures. They have many monitoring choices (Datadog, New Relic, etc.) and significant power to demand performance and specific features.",
        "competitors": "Direct: Datadog, New Relic, Dynatrace. Indirect: Open-source solutions like Prometheus + Grafana.",
        "substitutes": "In-house custom monitoring scripts (Python/Bash), manual log checking by DevOps teams, relying on cloud provider's basic monitoring (e.g., CloudWatch), or simply 'doing nothing' until a major incident occurs.",
        "suppliers": "Primary dependencies are on cloud providers (AWS, GCP, Azure) for log data APIs and infrastructure. A change in their API terms, rate limits, or pricing could significantly impact our service.",
        "newEntrants": "Observability platforms like Honeycomb or Grafana Labs could easily extend their offerings. Large tech companies (e.g., Cloudflare, AWS) could bundle a more advanced, competitive monitoring solution into their platforms.",
        "selectedForces": ["substitutes", "customers"]
    }
    </script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const CompetitiveSnapshotActivity = () => {
            // State for each force's textarea
            const [customers, setCustomers] = useState('');
            const [competitors, setCompetitors] = useState('');
            const [substitutes, setSubstitutes] = useState('');
            const [suppliers, setSuppliers] = useState('');
            const [newEntrants, setNewEntrants] = useState('');

            // State for tracking selected forces
            const [selectedForces, setSelectedForces] = useState([]);
            
            // App state
            const [activityComplete, setActivityComplete] = useState(false);
            const [devMode, setDevMode] = useState(false);
            const [devFillLoading, setDevFillLoading] = useState(false);

            useEffect(() => {
                if (selectedForces.length === 2) {
                    setActivityComplete(true);
                } else {
                    setActivityComplete(false);
                }
            }, [selectedForces]);

            const handleForceSelection = (forceId) => {
                setSelectedForces(prev => {
                    if (prev.includes(forceId)) {
                        return prev.filter(id => id !== forceId);
                    } else {
                        if (prev.length < 2) {
                            return [...prev, forceId];
                        } else {
                            // Show notification if trying to select more than 2
                            const notification = document.getElementById('notification-bar');
                            if(notification) {
                                notification.classList.add('show');
                                setTimeout(() => notification.classList.remove('show'), 3000);
                            }
                            return prev;
                        }
                    }
                });
            };
            
            const toggleDevMode = () => setDevMode(!devMode);

            const devFillData = () => {
                setDevFillLoading(true);
                try {
                    const testData = JSON.parse(document.getElementById('testData').textContent);
                    setCustomers(testData.customers);
                    setCompetitors(testData.competitors);
                    setSubstitutes(testData.substitutes);
                    setSuppliers(testData.suppliers);
                    setNewEntrants(testData.newEntrants);
                    setSelectedForces(testData.selectedForces || []);
                    console.log('‚úÖ Dev data loaded successfully');
                } catch (error) {
                    console.error('‚ùå Failed to load dev data:', error);
                } finally {
                    setDevFillLoading(false);
                }
            };
            
            const generateMarkdownSummary = () => {
                const timestamp = new Date().toLocaleString();
                const topForcesText = selectedForces.length > 0 ? selectedForces.map(f => f.charAt(0).toUpperCase() + f.slice(1)).join(', ') : '[Not selected]';

                return `# Competitive Strategy: Competitive Field Snapshot
Generated: ${timestamp}

### üìã Executive Summary
- **Top Two Forces Identified:** ${topForcesText}
- **Status:** Activity Complete

### üåè Competitive Forces Analysis

#### üéØ Customers (Buyers)
${customers || '[Not provided]'}

#### ‚öîÔ∏è Competitors (Direct Rivals)
${competitors || '[Not provided]'}

####  alternativa Substitutes / DIY
${substitutes || '[Not provided]'}

#### üîó Suppliers / Dependencies
${suppliers || '[Not provided]'}

#### üöÄ New Entrants
${newEntrants || '[Not provided]'}

---
### üìÖ Assessment Details
- **Activity:** 1 - Competitive Field Snapshot
- **Workshop:** Competitive Strategy Principles
- **Next Step:** Use the top two forces to inform 'Where to Play' choices.
`;
            };

            const handleCopyToClipboard = () => {
                const markdown = generateMarkdownSummary();
                navigator.clipboard.writeText(markdown).then(() => {
                    const notification = document.createElement('div');
                    notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg animate-fadeIn z-50';
                    notification.textContent = '‚úÖ Snapshot analysis copied!';
                    document.body.appendChild(notification);
                    setTimeout(() => {
                        notification.style.transition = 'opacity 0.5s';
                        notification.style.opacity = '0';
                        setTimeout(() => notification.remove(), 500);
                    }, 3000);
                });
            };

            const ForceBox = ({ id, title, question, tooltip, placeholder, value, setter }) => {
                const isSelected = selectedForces.includes(id);
                return (
                    <div id={id} className={`force-box absolute w-80 p-4 border-2 rounded-xl bg-white shadow-lg transition-all duration-300 ${isSelected ? 'selected' : 'border-gray-200'}`}>
                        <h3 className="text-lg font-semibold text-gray-800 flex justify-between items-center">
                            {title}
                            <div className="relative group">
                                <span className="text-gray-400 cursor-pointer border border-gray-400 rounded-full w-5 h-5 flex items-center justify-center text-xs">?</span>
                                <div className="absolute bottom-full left-1/2 -translate-x-1/2 w-60 p-2 bg-gray-700 text-white text-xs rounded-md opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none mb-2">
                                    {tooltip}
                                </div>
                            </div>
                        </h3>
                        <p className="text-xs text-gray-500 italic mt-1 mb-2">{question}</p>
                        <textarea
                            value={value}
                            onChange={(e) => setter(e.target.value)}
                            placeholder={placeholder}
                            className="w-full p-2 border border-gray-300 rounded-md text-sm transition-all h-24 focus:border-orange-500 focus:ring-1 focus:ring-orange-500"
                            rows="3"
                        />
                        <div className="mt-2">
                            <button onClick={() => handleForceSelection(id)} className={`w-full py-1.5 px-3 text-sm font-semibold rounded-md transition-colors ${isSelected ? 'bg-orange-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}>
                                {isSelected ? '‚úì Selected' : 'Select as Top Force'}
                            </button>
                        </div>
                    </div>
                );
            };

            return (
                <div className="max-w-6xl mx-auto p-4 md:p-8">
                    <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
                        <div className="flex justify-between items-center w-full mb-2">
                            <a href="index.html" className="text-orange-600 hover:text-orange-700 font-medium text-sm">‚Üê Back to Workshop</a>
                            <a href="../index.html" className="text-orange-600 hover:text-orange-700 font-medium text-sm">All GTM Workshops ‚Üë</a>
                        </div>
                        <div className="border-t border-gray-200 mt-3 pt-4">
                            <h1 onDoubleClick={toggleDevMode} className={`text-2xl font-bold text-gray-800 cursor-pointer select-none ${devMode ? 'text-orange-600' : ''}`} title="Double-click to toggle dev mode">
                                Activity 1: Competitive Field Snapshot {devMode && 'üîß'}
                            </h1>
                            <p className="text-gray-600 text-sm mt-1">Identify the pressures shaping your market, then select the <strong>top two forces</strong> that matter most to your startup right now.</p>
                             {devMode && (
                                <div className="mt-3 pt-3 border-t border-orange-200">
                                    <div className="flex items-center justify-between">
                                        <span className="text-xs text-orange-600 font-medium">üîß Dev Mode Active</span>
                                        <button onClick={devFillData} disabled={devFillLoading} className="bg-orange-500 text-white px-3 py-1 rounded text-xs hover:bg-orange-600 transition-colors disabled:opacity-50">
                                            {devFillLoading ? '‚è≥ Loading...' : 'üìù Fill Test Data'}
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>

                    <div id="notification-bar" className="fixed top-5 right-5 bg-yellow-500 text-white px-6 py-3 rounded-lg shadow-lg opacity-0 transition-opacity duration-300 pointer-events-none">You can only select up to two forces.</div>

                    <div className="relative w-full h-[900px] my-10 hidden md:block">
                        {/* Center Interactive Competitors Box */}
                        <div className={`absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-80 h-56 bg-[#3B82F6] text-white rounded-xl flex flex-col items-center justify-center p-4 z-10 shadow-lg transition-all duration-300 ${selectedForces.includes('competitors') ? 'ring-4 ring-orange-400' : ''}`}>
                            <h3 className="text-lg font-semibold mb-2 text-center">Competitors (Rivals)</h3>
                            <p className="text-xs text-blue-100 mb-2 text-center">Who else is chasing this problem?</p>
                            <textarea
                                value={competitors}
                                onChange={(e) => setCompetitors(e.target.value)}
                                placeholder="e.g., New Relic, Datadog"
                                className="w-full h-28 p-2 border border-blue-300 rounded-md text-sm text-gray-800 bg-white/90 focus:bg-white focus:border-orange-500 focus:ring-1 focus:ring-orange-500 resize-none"
                                rows="4"
                            />
                            <button 
                                onClick={() => handleForceSelection('competitors')} 
                                className={`mt-2 w-full py-1.5 px-3 text-sm font-semibold rounded-md transition-colors ${selectedForces.includes('competitors') ? 'bg-orange-500 text-white' : 'bg-white/20 text-white hover:bg-white/30'}`}
                            >
                                {selectedForces.includes('competitors') ? '‚úì Selected' : 'Select as Top Force'}
                            </button>
                        </div>
                        
                        <ForceBox id="newEntrants" title="New Entrants" question="Who else could easily enter?" tooltip="Adjacent startups, big tech expansions." placeholder="e.g., Grafana Labs could extend into this." value={newEntrants} setter={setNewEntrants} />
                        <ForceBox id="suppliers" title="Suppliers / Dependencies" question="What providers do you depend on?" tooltip="APIs, data sources, platforms. If they change terms, what happens?" placeholder="e.g., AWS logs API." value={suppliers} setter={setSuppliers} />
                        <ForceBox id="buyers" title="Customers (Buyers)" question="How much choice do they have?" tooltip="Buyers with many choices have more power." placeholder="e.g., Mid-market IT leads have 10+ choices." value={customers} setter={setCustomers} />
                        <ForceBox id="substitutes" title="Substitutes / DIY" question="How else can buyers solve this?" tooltip="DIY scripts, spreadsheets, consultants all count." placeholder="e.g., Python scripts + cron jobs." value={substitutes} setter={setSubstitutes} />

                        {/* Arrows removed - to be fixed later */}
                        

                        {/* Positioning for Force Boxes - Balanced spacing */}
                        <style>{`
                            #newEntrants { top: 60px; left: 50%; transform: translateX(-50%); }
                            #suppliers { top: 50%; left: -20px; transform: translateY(-50%); }
                            #buyers { top: 50%; right: -20px; transform: translateY(-50%); }
                            #substitutes { bottom: 60px; left: 50%; transform: translateX(-50%); }
                        `}</style>
                    </div>

                    {/* Mobile / Fallback Layout */}
                    <div className="grid grid-cols-1 md:hidden gap-6">
                         <ForceBox id="newEntrants-mob" title="New Entrants" question="Who else could easily enter?" tooltip="Adjacent startups, big tech expansions." placeholder="e.g., Grafana Labs could extend into this." value={newEntrants} setter={setNewEntrants} />
                         <ForceBox id="competitors-mob" title="Competitors (Rivals)" question="Who else is chasing this problem?" tooltip="Be specific. Name companies, not 'everyone.'" placeholder="e.g., New Relic, Datadog." value={competitors} setter={setCompetitors} />
                         <ForceBox id="buyers-mob" title="Customers (Buyers)" question="How much choice do they have?" tooltip="Buyers with many choices have more power." placeholder="e.g., Mid-market IT leads have 10+ choices." value={customers} setter={setCustomers} />
                         <ForceBox id="suppliers-mob" title="Suppliers / Dependencies" question="What providers do you depend on?" tooltip="APIs, data sources, platforms. If they change terms, what happens?" placeholder="e.g., AWS logs API." value={suppliers} setter={setSuppliers} />
                         <ForceBox id="substitutes-mob" title="Substitutes / DIY" question="How else can buyers solve this?" tooltip="DIY scripts, spreadsheets, consultants all count." placeholder="e.g., Python scripts + cron jobs." value={substitutes} setter={setSubstitutes} />
                    </div>
                    
                    {activityComplete && (
                        <div className="bg-gray-50 rounded-xl p-6 border border-gray-200 mt-8 animate-fadeIn">
                            <h3 className="text-lg font-semibold text-gray-800 mb-3">üìÑ Export Your Competitive Field Snapshot</h3>
                            <p className="text-sm text-gray-600 mb-4">
                                Copy your completed analysis as formatted text for easy sharing in documents or presentations.
                            </p>
                            <button
                                onClick={handleCopyToClipboard}
                                className="bg-orange-500 text-white px-6 py-2.5 rounded-lg font-medium hover:bg-orange-600 transition-colors"
                            >
                                Copy Activity Summary
                            </button>
                        </div>
                    )}
                </div>
            );
        };

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<CompetitiveSnapshotActivity />);
    </script>
</body>
</html>