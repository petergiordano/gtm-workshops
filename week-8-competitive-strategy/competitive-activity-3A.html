<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activity 3: Competitive Strategy Blueprint</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&family=Raleway:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Open Sans', 'Raleway', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background-color: #fafafa;
        }
        .animate-fadeIn { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .blueprint-table td { padding: 12px 16px; }
        .blueprint-table tr:not(:last-child) { border-bottom: 1px solid #e5e7eb; }
        .blueprint-label { font-weight: 600; color: #4b5563; }
        .sticky-blueprint { position: sticky; top: 100px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="application/json" id="testData">
    {
        "wedge": "Mid-market B2B SaaS teams (50-500 employees)",
        "topForces": "High power of Substitutes (DIY scripts); High power of Customers (Buyers) who have many choices.",
        "whereToPlay": "We play in mid-market B2B SaaS teams who are struggling with unreliable, custom-built API monitoring scripts and cannot afford enterprise-grade observability platforms.",
        "howToWin": "We win with a monitoring solution that sets up in minutes, provides predictive failure alerts via a proprietary ML model, and has transparent, usage-based pricing.",
        "keySubstitutes": "In-house Python/Bash scripts, manual log checking by DevOps, basic cloud provider monitoring (e.g., CloudWatch).",
        "criticalCapabilities": "1. Proprietary machine learning models for predictive failure detection. 2. Seamless 10-minute onboarding process across all major cloud platforms. 3. Real-time automated incident resolution capabilities.",
        "requiredSystems": "1. Unified data analytics platform to process multi-cloud API telemetry. 2. Automated customer value-reporting engine. 3. ML model training and deployment infrastructure.",
        "valueMetric": "Reduction in API incident resolution time (MTTR) by 50%+",
        "earlySignals": "1. Weekly active users per account > 3. 2. At least 5 predictive alerts configured within the first week. 3. Reduction in P1/P2 incidents reported by customers.",
        "keyRisks": "1. A major competitor (e.g., Datadog) launches a similar, low-cost predictive feature. 2. Our ML model for predictions is not accurate enough in diverse real-world environments.",
        "counterMoves": "1. If competitor launches, we will double down on our 'setup-in-minutes' value prop and our superior customer support. 2. We will build a 'model tuning' feature to allow customers to improve accuracy for their specific use case.",
        "firstTests": "1. Test pricing model with 10 new prospects to confirm value perception. (Owner: Sarah, by Aug 29). 2. Onboard 3 design partners to validate the accuracy of predictive alerts. (Owner: Tom, by Sep 5).",
        "blueprintStep": 3
    }
    </script>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        const WORKSHOP_STORAGE_KEY = 'workshopState_competitive_strategy';

        /**
         * Loads the entire workshop state from localStorage using a specific key.
         * @param {string} storageKey - The unique key for the workshop's state.
         * @returns {object} The parsed workshop state or an empty object.
         */
        const loadWorkshopState = (storageKey) => {
            try {
                const savedState = localStorage.getItem(storageKey);
                return savedState ? JSON.parse(savedState) : {};
            } catch (error) {
                console.error("Could not load state from localStorage", error);
                return {};
            }
        };

        /**
         * Saves a piece of state by merging it into the existing workshop state.
         * @param {object} stateToSave - An object containing the key-value pairs to save.
         * @param {string} storageKey - The unique key for the workshop's state.
         */
        const saveWorkshopState = (stateToSave, storageKey) => {
            try {
                const currentState = loadWorkshopState(storageKey);
                const newState = { ...currentState, ...stateToSave };
                localStorage.setItem(storageKey, JSON.stringify(newState));
            } catch (error) {
                console.error("Could not save state to localStorage", error);
            }
        };

        // CORRECTED: Helper components are defined OUTSIDE the main component
        const StepIndicator = ({ step, title, active, completed }) => (
            <div className="flex items-center">
                <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold ${
                    completed ? 'bg-green-500 text-white' :
                    active ? 'bg-orange-500 text-white' : 'bg-gray-200 text-gray-600'
                }`}>
                    {completed ? '‚úì' : step}
                </div>
                <div className="ml-3">
                    <h4 className={`font-semibold ${
                        completed ? 'text-green-600' :
                        active ? 'text-orange-600' : 'text-gray-700'
                    }`}>{title}</h4>
                </div>
            </div>
        );

        const WizardStepIndicator = ({ blueprintStep, isStep2Complete, isStep3Complete }) => (
            <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
                <div className="flex justify-between items-center">
                    <StepIndicator 
                        step={1} 
                        title="Review" 
                        active={blueprintStep === 1} 
                        completed={blueprintStep > 1}
                    />
                    <div className={`flex-1 h-0.5 mx-4 ${blueprintStep > 1 ? 'bg-green-500' : 'bg-gray-200'}`}></div>
                    <StepIndicator 
                        step={2} 
                        title="Define" 
                        active={blueprintStep === 2} 
                        completed={blueprintStep > 2 || (blueprintStep === 2 && isStep2Complete)}
                    />
                    <div className={`flex-1 h-0.5 mx-4 ${(blueprintStep > 2 || (blueprintStep === 2 && isStep2Complete)) ? 'bg-green-500' : 'bg-gray-200'}`}></div>
                    <StepIndicator 
                        step={3} 
                        title="Plan" 
                        active={blueprintStep === 3} 
                        completed={blueprintStep === 3 && isStep3Complete}
                    />
                </div>
            </div>
        );

        const InputField = ({ label, tooltip, value, setter, placeholder, rows=3 }) => (
             <div className="mb-6">
                <label className="block text-base font-semibold text-gray-800 mb-2 relative group">
                    {label}
                    <span className="absolute -top-0.5 -right-0.5 text-gray-400 cursor-pointer border border-gray-400 rounded-full w-5 h-5 flex items-center justify-center text-xs">?</span>
                    <div className="absolute bottom-full left-1/2 -translate-x-1/2 w-64 p-2 bg-gray-700 text-white text-xs rounded-md opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none mb-2 z-10">
                        {tooltip}
                    </div>
                </label>
                <textarea value={value} onChange={(e) => setter(e.target.value)} placeholder={placeholder} rows={rows} className="w-full p-3 border border-gray-300 rounded-lg text-sm focus:border-orange-500 focus:ring-1 focus:ring-orange-500" />
             </div>
        );

        const BlueprintActivity = () => {
            // Load read-only data from localStorage (from previous activities)
            const workshopData = useMemo(() => loadWorkshopState(WORKSHOP_STORAGE_KEY), []);
            
            // Process and transform data from Activities 1 & 2 for display
            const topForcesText = (workshopData.selectedForces || []).map(s => s.charAt(0).toUpperCase() + s.slice(1)).join(', ');
            const keySubstitutesText = workshopData.substitutes || '';
            const whereToPlayText = `We play in ${workshopData.targetSegment || '[segment]'}, for ${workshopData.specificBuyer || '[buyer]'}, who have ${workshopData.urgentProblem || '[problem]'}.`;
            const howToWinText = `We win by delivering ${workshopData.value1 || '[value 1]'} through ${workshopData.capability1 || '[capability 1]'}, ${workshopData.value2 || '[value 2]'} through ${workshopData.capability2 || '[capability 2]'}, and ${workshopData.value3 || '[value 3]'} through ${workshopData.capability3 || '[capability 3]'}.`;
            
            // Step 2: Define Your Advantage & Measures state variables
            const [criticalCapabilities, setCriticalCapabilities] = useState(loadWorkshopState(WORKSHOP_STORAGE_KEY).criticalCapabilities || '');
            const [requiredSystems, setRequiredSystems] = useState(loadWorkshopState(WORKSHOP_STORAGE_KEY).requiredSystems || '');
            const [valueMetric, setValueMetric] = useState(loadWorkshopState(WORKSHOP_STORAGE_KEY).valueMetric || '');
            const [earlySignals, setEarlySignals] = useState(loadWorkshopState(WORKSHOP_STORAGE_KEY).earlySignals || '');
            
            // Step 3: Plan Your Action state variables
            const [keyRisks, setKeyRisks] = useState(loadWorkshopState(WORKSHOP_STORAGE_KEY).keyRisks || '');
            const [counterMoves, setCounterMoves] = useState(loadWorkshopState(WORKSHOP_STORAGE_KEY).counterMoves || '');
            const [firstTests, setFirstTests] = useState(loadWorkshopState(WORKSHOP_STORAGE_KEY).firstTests || '');

            // Wizard navigation state
            const [blueprintStep, setBlueprintStep] = useState(loadWorkshopState(WORKSHOP_STORAGE_KEY).blueprintStep || 1);

            // App state
            const [devMode, setDevMode] = useState(false);
            const [devFillLoading, setDevFillLoading] = useState(false);
            const [showExportSection, setShowExportSection] = useState(false);

            // Step completion validation
            const isStep2Complete = useMemo(() => criticalCapabilities && requiredSystems && valueMetric && earlySignals, [criticalCapabilities, requiredSystems, valueMetric, earlySignals]);
            const isStep3Complete = useMemo(() => keyRisks && counterMoves && firstTests, [keyRisks, counterMoves, firstTests]);
            const activityComplete = isStep2Complete && isStep3Complete;
            
            // Step-based progress calculation
            const progress = useMemo(() => {
                if(blueprintStep === 1) return 33;
                if(blueprintStep === 2) return isStep2Complete ? 66 : 33;
                if(blueprintStep === 3) return isStep3Complete ? 100 : 66;
                return 33;
            }, [blueprintStep, isStep2Complete, isStep3Complete]);

            // Auto-save state to localStorage whenever any form data changes
            useEffect(() => {
                const currentState = {
                    criticalCapabilities,
                    requiredSystems,
                    valueMetric,
                    earlySignals,
                    keyRisks,
                    counterMoves,
                    firstTests,
                    blueprintStep
                };
                saveWorkshopState(currentState, WORKSHOP_STORAGE_KEY);
            }, [criticalCapabilities, requiredSystems, valueMetric, earlySignals, keyRisks, counterMoves, firstTests, blueprintStep]);

            const toggleDevMode = () => setDevMode(!devMode);

            // Navigation functions
            const goToNextStep = () => {
                if (blueprintStep < 3) {
                    setBlueprintStep(blueprintStep + 1);
                }
            };

            const goToPrevStep = () => {
                if (blueprintStep > 1) {
                    setBlueprintStep(blueprintStep - 1);
                }
            };

            // Navigation validation
            const canContinueFromStep2 = isStep2Complete;
            const canCompleteFromStep3 = isStep3Complete;

            const devFillData = () => {
                setDevFillLoading(true);
                try {
                    const data = JSON.parse(document.getElementById('testData').textContent);
                    setCriticalCapabilities(data.criticalCapabilities);
                    setRequiredSystems(data.requiredSystems);
                    setValueMetric(data.valueMetric);
                    setEarlySignals(data.earlySignals); 
                    setKeyRisks(data.keyRisks); 
                    setCounterMoves(data.counterMoves);
                    setFirstTests(data.firstTests);
                    setBlueprintStep(3); // Move to final step to show completed state
                    console.log('‚úÖ Dev data loaded successfully');
                } catch (e) { 
                    console.error('‚ùå Failed to load dev data:', e); 
                } finally { 
                    setDevFillLoading(false); 
                }
            };
            
            const resetActivity = () => {
                setCriticalCapabilities('');
                setRequiredSystems('');
                setValueMetric('');
                setEarlySignals('');
                setKeyRisks('');
                setCounterMoves('');
                setFirstTests('');
                setBlueprintStep(1); // Reset to first step
                setShowExportSection(false); // Reset export section visibility
                
                // Clear localStorage data for this activity's input fields only
                const currentState = loadWorkshopState(WORKSHOP_STORAGE_KEY);
                const emptyState = {
                    ...currentState, // Preserve data from Activities 1 & 2
                    criticalCapabilities: '',
                    requiredSystems: '',
                    valueMetric: '',
                    earlySignals: '',
                    keyRisks: '',
                    counterMoves: '',
                    firstTests: '',
                    blueprintStep: 1
                };
                saveWorkshopState(emptyState, WORKSHOP_STORAGE_KEY);
            };
            
            const generateMarkdownSummary = () => {
                return `# Competitive Strategy: 1-Page Blueprint

### üöÄ Our Strategic Foundation
* **Top Two Forces:** ${topForcesText || '[Not provided]'}
* **Key Substitutes:** ${keySubstitutesText || '[Not provided]'}

### üéØ Where We Play
> ${whereToPlayText || '[Not provided]'}

### üèÜ How We Win
> ${howToWinText || '[Not provided]'}

---

### üõ†Ô∏è Our Advantage & Measures

**Critical Capabilities:**
${criticalCapabilities || '[Not provided]'}

**Required Systems:**
${requiredSystems || '[Not provided]'}

**Value Metric:**
${valueMetric || '[Not provided]'}

**Early Signals:**
${earlySignals || '[Not provided]'}

---

### üß™ Our Action Plan

**Key Risks:**
${keyRisks || '[Not provided]'}

**Counter-Moves:**
${counterMoves || '[Not provided]'}

**First Tests:**
${firstTests || '[Not provided]'}
`;
            };

            const handleCopyToClipboard = () => {
                const markdown = generateMarkdownSummary();
                navigator.clipboard.writeText(markdown).then(() => {
                    const notification = document.createElement('div');
                    notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg animate-fadeIn z-50';
                    notification.textContent = '‚úÖ Blueprint copied to clipboard!';
                    document.body.appendChild(notification);
                    setTimeout(() => {
                        notification.style.transition = 'opacity 0.5s';
                        notification.style.opacity = '0';
                        setTimeout(() => notification.remove(), 500);
                    }, 3000);
                });
            };

            const BlueprintTable = () => (
                <div className="bg-white rounded-xl border-2 border-gray-200 shadow-lg sticky-blueprint">
                    <h3 className="text-xl font-bold text-gray-800 p-4 border-b-2 border-gray-200">Your 1-Page Blueprint</h3>
                    <table className="w-full text-sm blueprint-table">
                        <tbody>
                            <tr><td className="w-1/3 blueprint-label">Top Two Forces (Now)</td><td>{topForcesText || '...'}</td></tr>
                            <tr><td className="blueprint-label">Where We Play</td><td>{whereToPlayText || '...'}</td></tr>
                            <tr><td className="blueprint-label">How We Win</td><td>{howToWinText || '...'}</td></tr>
                            <tr><td className="blueprint-label">Key Substitutes</td><td>{keySubstitutesText || '...'}</td></tr>
                            <tr><td className="blueprint-label">Critical Capabilities</td><td>{criticalCapabilities || '...'}</td></tr>
                            <tr><td className="blueprint-label">Required Systems</td><td>{requiredSystems || '...'}</td></tr>
                            <tr><td className="blueprint-label">Value Metric</td><td>{valueMetric || '...'}</td></tr>
                            <tr><td className="blueprint-label">Early Signals (2‚Äì3)</td><td>{earlySignals || '...'}</td></tr>
                            <tr><td className="blueprint-label">Key Risks</td><td>{keyRisks || '...'}</td></tr>
                            <tr><td className="blueprint-label">Counter-Moves</td><td>{counterMoves || '...'}</td></tr>
                            <tr><td className="blueprint-label">First Tests</td><td>{firstTests || '...'}</td></tr>
                        </tbody>
                    </table>
                </div>
            );

            return (
                <div className="max-w-7xl mx-auto p-4 md:p-8">
                    <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
                         <div className="flex justify-between items-center w-full mb-2">
                            <a href="index.html" className="text-orange-600 hover:text-orange-700 font-medium text-sm">‚Üê Back to Workshop</a>
                            <a href="../index.html" className="text-orange-600 hover:text-orange-700 font-medium text-sm">All GTM Workshops ‚Üë</a>
                        </div>
                        <div className="border-t border-gray-200 mt-3 pt-4">
                            <h1 onDoubleClick={toggleDevMode} className={`text-2xl font-bold text-gray-800 cursor-pointer select-none ${devMode ? 'text-orange-600' : ''}`} title="Double-click to toggle dev mode">
                                Activity 3: Assemble Your Blueprint {devMode && 'üîß'}
                            </h1>
                            <p className="text-gray-600 text-sm mt-1">Combine your insights into a single, actionable strategy document.</p>
                             {devMode && (
                                <div className="mt-3 pt-3 border-t border-orange-200">
                                    <div className="flex items-center justify-between">
                                        <span className="text-xs text-orange-600 font-medium">üîß Dev Mode Active</span>
                                        <button onClick={devFillData} disabled={devFillLoading} className="bg-orange-500 text-white px-3 py-1 rounded text-xs hover:bg-orange-600 transition-colors disabled:opacity-50">
                                            {devFillLoading ? '‚è≥ Loading...' : 'üìù Fill Test Data'}
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                    
                    <WizardStepIndicator 
                        blueprintStep={blueprintStep} 
                        isStep2Complete={isStep2Complete} 
                        isStep3Complete={isStep3Complete} 
                    />
                    
                    <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6">
                        <div className="flex items-center justify-between mb-2">
                            <span className="text-sm font-medium text-gray-700">Blueprint Progress</span>
                            <span className="text-sm font-semibold text-gray-800">{progress}% Complete</span>
                        </div>
                        <div className="w-full bg-gray-200 rounded-full h-2.5">
                            <div className="bg-orange-500 h-2.5 rounded-full transition-all duration-500" style={{width: `${progress}%`}}></div>
                        </div>
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div> {/* Left Column for Inputs */}
                            
                            {/* Step 1: Review Your Foundation */}
                            {blueprintStep === 1 && (
                                <div className="mb-8">
                                    <h2 className="text-xl font-bold mb-4">Step 1: Review Your Foundation</h2>
                                    <p className="text-sm text-gray-600 mb-6">Review your key strategic choices from Activities 1 and 2.</p>
                                    
                                    <div className="mb-4">
                                        <h4 className="text-sm font-semibold text-gray-600">Your Top Two Forces (from Activity 1)</h4>
                                        <p className="mt-1 text-sm text-gray-800 bg-gray-50 p-3 rounded-md">
                                            {topForcesText || "Data from Activity 1 will appear here."}
                                        </p>
                                    </div>

                                    <div className="mb-4">
                                        <h4 className="text-sm font-semibold text-gray-600">Your "Where to Play" Statement (from Activity 2)</h4>
                                        <p className="mt-1 text-sm text-gray-800 bg-gray-50 p-3 rounded-md">
                                            {whereToPlayText || "Data from Activity 2 will appear here."}
                                        </p>
                                    </div>

                                    <div className="mb-4">
                                        <h4 className="text-sm font-semibold text-gray-600">Your "How to Win" Strategy (from Activity 2)</h4>
                                        <p className="mt-1 text-sm text-gray-800 bg-gray-50 p-3 rounded-md">
                                            {howToWinText || "Data from Activity 2 will appear here."}
                                        </p>
                                    </div>

                                    <div className="mb-4">
                                        <h4 className="text-sm font-semibold text-gray-600">Key Substitutes (from Activity 1)</h4>
                                        <p className="mt-1 text-sm text-gray-800 bg-gray-50 p-3 rounded-md">
                                            {keySubstitutesText || "Data from Activity 1 will appear here."}
                                        </p>
                                    </div>
                                </div>
                            )}

                            {/* Step 2: Define Your Advantage & Measures */}
                            {blueprintStep === 2 && (
                                <div className="mb-8">
                                    <h2 className="text-xl font-bold mb-4">Step 2: Define Your Advantage & Measures</h2>
                                    <p className="text-sm text-gray-600 mb-6">Define the capabilities and systems you need, plus how you'll measure success.</p>
                                    
                                    <InputField
                                        label="Critical Capabilities"
                                        tooltip="To deliver your 'How to Win', what 2-3 activities must your company perform flawlessly?"
                                        value={criticalCapabilities}
                                        setter={setCriticalCapabilities}
                                        placeholder="e.g., 1. Proprietary ML model development. 2. Seamless 10-minute customer onboarding."
                                        rows={3}
                                    />
                                    
                                    <InputField
                                        label="Required Systems"
                                        tooltip="What management systems, tools, or infrastructure are required to support those critical capabilities?"
                                        value={requiredSystems}
                                        setter={setRequiredSystems}
                                        placeholder="e.g., 1. Unified data analytics platform. 2. Automated value-reporting engine for customers."
                                        rows={3}
                                    />
                                    
                                    <InputField
                                        label="Value Metric"
                                        tooltip="How does your customer measure the value you deliver? This should be an outcome, not a feature."
                                        value={valueMetric}
                                        setter={setValueMetric}
                                        placeholder="e.g., Reduction in API incident resolution time (MTTR) by 50%+"
                                        rows={2}
                                    />
                                    
                                    <InputField
                                        label="Early Signals (2-3)"
                                        tooltip="What leading indicators prove your strategy is working? These should predict the Value Metric."
                                        value={earlySignals}
                                        setter={setEarlySignals}
                                        placeholder="e.g., 1. Weekly active users per account > 3. 2. At least 5 predictive alerts configured."
                                        rows={3}
                                    />
                                </div>
                            )}

                            {/* Step 3: Plan Your Action */}
                            {blueprintStep === 3 && (
                                <div className="mb-8">
                                    <h2 className="text-xl font-bold mb-4">Step 3: Plan Your Action</h2>
                                    <p className="text-sm text-gray-600 mb-6">Identify additional risks and plan concrete next steps to test your strategy.</p>
                                    
                                    <InputField
                                        label="Other Key Risks"
                                        tooltip="You already identified your single riskiest assumption in Activity 2. What are 1-2 other key risks that could break your strategy?"
                                        value={keyRisks}
                                        setter={setKeyRisks}
                                        placeholder="e.g., 1. A major competitor launches a similar 'good enough' predictive feature."
                                        rows={3}
                                    />
                                    
                                    <InputField
                                        label="Counter-Moves"
                                        tooltip="If the risks you identified happen, what is your pre-planned response?"
                                        value={counterMoves}
                                        setter={setCounterMoves}
                                        placeholder="e.g., If competitor launches, double down on our 'setup-in-minutes' value prop and superior support."
                                        rows={3}
                                    />
                                    
                                    <InputField
                                        label="First Tests"
                                        tooltip="Based on the test you designed in Activity 2, what are two more concrete tests for the next 30 days? Assign an owner and a date."
                                        value={firstTests}
                                        setter={setFirstTests}
                                        placeholder="e.g., 1. Test pricing model with 10 new prospects (Owner: Sarah, by Aug 29)."
                                        rows={3}
                                    />
                                </div>
                            )}

                            {/* Navigation Buttons */}
                            <div className="flex justify-between items-center mt-8">
                                {/* Back Button */}
                                <button
                                    onClick={goToPrevStep}
                                    disabled={blueprintStep === 1}
                                    className={`px-6 py-2 rounded-lg font-medium transition-colors ${
                                        blueprintStep === 1 
                                            ? 'bg-gray-200 text-gray-400 cursor-not-allowed' 
                                            : 'bg-gray-500 text-white hover:bg-gray-600'
                                    }`}
                                >
                                    ‚Üê Back
                                </button>

                                {/* Reset Button */}
                                <button 
                                    onClick={resetActivity} 
                                    className="bg-red-500 text-white px-6 py-2 rounded-lg font-medium hover:bg-red-600 transition-colors"
                                >
                                    Reset Activity
                                </button>

                                {/* Continue/Complete Button */}
                                {blueprintStep < 3 ? (
                                    <button
                                        onClick={goToNextStep}
                                        disabled={blueprintStep === 2 && !canContinueFromStep2}
                                        className={`px-6 py-2 rounded-lg font-medium transition-colors ${
                                            (blueprintStep === 2 && !canContinueFromStep2)
                                                ? 'bg-gray-200 text-gray-400 cursor-not-allowed' 
                                                : 'bg-orange-500 text-white hover:bg-orange-600'
                                        }`}
                                    >
                                        Continue ‚Üí
                                    </button>
                                ) : (
                                    <button
                                        onClick={() => setShowExportSection(true)}
                                        disabled={!canCompleteFromStep3}
                                        className={`px-6 py-2 rounded-lg font-medium transition-colors ${
                                            !canCompleteFromStep3
                                                ? 'bg-gray-200 text-gray-400 cursor-not-allowed' 
                                                : 'bg-green-500 text-white hover:bg-green-600'
                                        }`}
                                    >
                                        Generate Report
                                    </button>
                                )}
                            </div>
                        </div>

                        <div> {/* Right Column for Blueprint */}
                            <BlueprintTable />
                        </div>
                    </div>
                    
                    {showExportSection && (
                        <div className="bg-gray-50 rounded-xl p-6 border border-gray-200 mt-8 animate-fadeIn">
                            <h3 className="text-lg font-semibold text-gray-800 mb-3">üìÑ Export Your Strategy Blueprint</h3>
                            <p className="text-sm text-gray-600 mb-4">
                                Your complete competitive strategy blueprint has been formatted as a professional markdown report for easy sharing and documentation.
                            </p>
                            
                            <div className="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4">
                                <h5 className="font-medium text-blue-800 mb-2">üìå Google Docs Instructions:</h5>
                                <ol className="text-sm text-blue-700 space-y-1">
                                    <li>1. Click "Copy Strategy Blueprint" below</li>
                                    <li>2. Open Google Docs and create a new document</li>
                                    <li>3. Go to <strong>Edit ‚Üí Paste special ‚Üí Paste from markdown</strong></li>
                                    <li>4. Your report will appear with proper formatting!</li>
                                </ol>
                                <p className="text-xs text-blue-600 mt-2">
                                    üí° <strong>Tip:</strong> "Paste from markdown" preserves all formatting including headers and sections.
                                </p>
                            </div>

                            <textarea
                                id="markdownSummary"
                                readOnly
                                className="w-full h-64 text-sm p-3 font-mono border border-gray-200 rounded-lg bg-gray-50 resize-none mb-3"
                                value={generateMarkdownSummary()}
                            />
                            
                            <div className="flex flex-col items-center">
                                <button
                                    onClick={handleCopyToClipboard}
                                    className="bg-orange-500 text-white px-6 py-2.5 rounded-lg font-medium hover:bg-orange-600 transition-colors"
                                >
                                    üìã Copy Strategy Blueprint
                                </button>
                                <div id="copyStatus"></div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<BlueprintActivity />);
    </script>
</body>
</html>