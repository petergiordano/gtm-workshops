<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GTM Channel Hypothesis Matrix (Part 1) - Channel Strategy</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700&family=Raleway:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Open Sans', 'Raleway', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #fafafa;
        }
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        textarea {
            resize: vertical;
            min-height: 60px;
        }
        textarea:focus, input:focus, select:focus {
            outline: none;
            border-color: #55BFFA;
            box-shadow: 0 0 0 3px rgba(85, 191, 250, 0.1);
        }
        .table-header {
            background-color: #f9fafb;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 0.75rem;
            color: #6b7280;
        }
        .channel-row:nth-child(even) {
            background-color: #f9fafb;
        }
        .channel-row:hover {
            background-color: #fef3c7;
            transition: background-color 0.2s ease;
        }
        .remove-button {
            opacity: 0.7;
            transition: all 0.2s ease;
        }
        .remove-button:hover {
            opacity: 1;
            background-color: #fee2e2;
        }
        select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- Test Data for Dev Mode -->
    <script type="application/json" id="testData">
    {
        "channels": [
            {
                "id": 1,
                "channelType": "Direct",
                "channelName": "Content Marketing & SEO",
                "rationale": "Targets developers searching for API monitoring solutions during awareness stage. Our technical blog content and documentation can rank for high-intent keywords like 'API monitoring best practices' that our ICP searches for.",
                "metric": ""
            },
            {
                "id": 2,
                "channelType": "Partner",
                "channelName": "Cloud Platform Marketplaces",
                "rationale": "Reaches buyers already using AWS/Azure who need monitoring. These marketplaces provide built-in trust and simplified procurement for enterprise buyers evaluating solutions.",
                "metric": ""
            },
            {
                "id": 3,
                "channelType": "Direct",
                "channelName": "Developer Community Engagement",
                "rationale": "Builds trust through technical content and open source contributions. Developers influence tool selection and prefer vendors who contribute to the community they're part of.",
                "metric": ""
            }
        ]
    }
    </script>

    <script type="text/babel">
        const { useState } = React;

        // Trash icon component
        const TrashIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
            </svg>
        );

        // Plus circle icon component
        const PlusCircleIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="16"></line>
                <line x1="8" y1="12" x2="16" y2="12"></line>
            </svg>
        );

        const ChannelHypothesisActivity = () => {
            // State for channels
            const [channels, setChannels] = useState([
                { id: 1, channelType: '', channelName: '', rationale: '', metric: '' },
                { id: 2, channelType: '', channelName: '', rationale: '', metric: '' },
                { id: 3, channelType: '', channelName: '', rationale: '', metric: '' }
            ]);

            // Dev mode state
            const [devMode, setDevMode] = useState(false);
            const [devFillLoading, setDevFillLoading] = useState(false);

            // Handle channel updates
            const handleChannelUpdate = (id, field, value) => {
                setChannels(prev => 
                    prev.map(channel => 
                        channel.id === id ? { ...channel, [field]: value } : channel
                    )
                );
            };

            // Add new channel
            const addChannel = () => {
                const maxId = channels.length > 0 ? Math.max(...channels.map(c => c.id)) : 0;
                setChannels(prev => [...prev, {
                    id: maxId + 1,
                    channelType: '',
                    channelName: '',
                    rationale: '',
                    metric: ''
                }]);
            };

            // Remove channel
            const removeChannel = (id) => {
                if (channels.length > 1) {
                    setChannels(prev => prev.filter(channel => channel.id !== id));
                }
            };

            // Toggle dev mode
            const toggleDevMode = () => {
                setDevMode(!devMode);
                console.log(devMode ? 'üîí Dev mode disabled' : 'üîì Dev mode enabled');
            };

            // Load test data
            const devFillData = () => {
                setDevFillLoading(true);
                try {
                    const testData = JSON.parse(document.getElementById('testData').textContent);
                    setChannels(testData.channels);
                    console.log('‚úÖ Dev data loaded successfully');
                } catch (error) {
                    console.error('‚ùå Failed to load dev data:', error);
                } finally {
                    setDevFillLoading(false);
                }
            };

            // Generate markdown summary
            const generateMarkdownSummary = () => {
                const timestamp = new Date().toLocaleString();
                const validChannels = channels.filter(ch => ch.channelName || ch.rationale);
                
                return `# GTM Channel Strategy - Channel Hypothesis Matrix
Generated: ${timestamp}

## Channel Strategy Overview

${validChannels.length === 0 ? '*No channels defined yet.*' : validChannels.map((channel, index) => `
### Channel ${index + 1}: ${channel.channelName || '[Unnamed Channel]'}

**Type:** ${channel.channelType || '[Not specified]'}

**Rationale:** ${channel.rationale || '[No rationale provided]'}

**Key Metric:** *To be defined in next activity*

---`).join('\n')}

## Channel Summary

**Total Channels Defined:** ${validChannels.length}
**Direct Channels:** ${validChannels.filter(ch => ch.channelType === 'Direct').length}
**Partner Channels:** ${validChannels.filter(ch => ch.channelType === 'Partner').length}

## Next Steps

1. Review and refine channel rationales based on buyer journey insights
2. Prioritize channels based on reach and effort
3. Define specific metrics for each channel in the next activity
`;
            };

            // Handle copy to clipboard
            const handleCopyToClipboard = () => {
                const copyToClipboard = async (text) => {
                    try {
                        if (navigator.clipboard && navigator.clipboard.writeText) {
                            await navigator.clipboard.writeText(text);
                            return true;
                        } else {
                            const textArea = document.createElement('textarea');
                            textArea.value = text;
                            textArea.style.position = 'fixed';
                            textArea.style.left = '-999999px';
                            document.body.appendChild(textArea);
                            textArea.select();
                            const successful = document.execCommand('copy');
                            document.body.removeChild(textArea);
                            return successful;
                        }
                    } catch (err) {
                        console.error('Failed to copy:', err);
                        return false;
                    }
                };

                const markdown = generateMarkdownSummary();
                const statusDiv = document.getElementById('copyStatus');
                
                copyToClipboard(markdown).then((success) => {
                    if (success) {
                        statusDiv.innerHTML = `
                            <div class="mt-2 bg-green-100 border border-green-400 text-green-700 px-4 py-2 rounded-lg animate-fadeIn">
                                <p class="font-medium">‚úÖ Copied to Clipboard!</p>
                                <p class="text-sm mt-1">Now paste in Google Docs: <strong>Edit ‚Üí Paste special ‚Üí Paste from markdown</strong></p>
                            </div>
                        `;
                        
                        // Create floating notification
                        const notification = document.createElement('div');
                        notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg animate-fadeIn z-50';
                        notification.textContent = '‚úÖ Channel strategy copied!';
                        document.body.appendChild(notification);
                        
                        setTimeout(() => {
                            notification.style.transition = 'opacity 0.5s';
                            notification.style.opacity = '0';
                            setTimeout(() => notification.remove(), 500);
                        }, 3000);
                    }
                });
            };

            return (
                <div className="max-w-[900px] mx-auto p-4">
                    {/* Header */}
                    <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
                        <div className="flex justify-between items-center w-full mb-2">
                            <a href="index.html" className="text-orange-600 hover:text-orange-700 font-medium">
                                ‚Üê Back to Workshop
                            </a>
                            <a href="../index.html" className="text-orange-600 hover:text-orange-700 font-medium">
                                All GTM Workshops ‚Üë
                            </a>
                        </div>

                        <div className="border-t border-gray-200 mt-3 pt-4">
                            <h1 
                                className={`text-xl font-bold text-gray-800 ${devMode ? 'text-orange-600' : ''} cursor-pointer select-none`}
                                onDoubleClick={toggleDevMode}
                                title="Double-click to toggle dev mode"
                            >
                                Activity 2: GTM Channel Hypothesis Matrix {devMode && 'üîß'}
                            </h1>
                            <p className="text-gray-600 text-sm mt-1">
                                Define channel strategies based on buyer journey insights
                            </p>

                            {devMode && (
                                <div className="mt-3 pt-3 border-t border-orange-200">
                                    <div className="flex items-center justify-between">
                                        <span className="text-xs text-orange-600 font-medium">üîß Dev Mode Active</span>
                                        <button
                                            onClick={devFillData}
                                            disabled={devFillLoading}
                                            className="bg-orange-500 text-white px-3 py-1 rounded text-xs hover:bg-orange-600 transition-colors disabled:opacity-50"
                                        >
                                            {devFillLoading ? '‚è≥ Loading...' : 'üìù Fill Test Data'}
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>

                    {/* Progress Bar */}
                    <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6">
                        <div className="flex items-center justify-between mb-2">
                            <span className="text-sm font-medium text-gray-700">Progress</span>
                            <span className="text-sm text-gray-600">In Progress</span>
                        </div>
                        <div className="w-full bg-gray-200 rounded-full h-2">
                            <div className="bg-orange-500 h-2 rounded-full transition-all duration-300" style={{width: '66%'}}></div>
                        </div>
                    </div>

                    {/* Main Content */}
                    <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
                        <div className="flex items-center gap-3 mb-3">
                            <div className="w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center">
                                <span className="text-orange-600 font-bold">2</span>
                            </div>
                            <h2 className="text-lg font-semibold text-gray-800">
                                GTM Channel Hypothesis Matrix
                            </h2>
                        </div>
                        <p className="text-gray-600 mb-6 ml-13 text-sm">
                            Based on your buyer's journey, hypothesize and prioritize your core channels and explain their rationale. You'll define metrics in the next step.
                        </p>

                            {/* Channel Matrix Table */}
                            <div className="overflow-x-auto">
                                <div className="min-w-full">
                                    {/* Table Header */}
                                    <div className="grid grid-cols-12 gap-4 p-4 table-header rounded-t-lg">
                                        <div className="col-span-2">Channel Type</div>
                                        <div className="col-span-3">Proposed Channel</div>
                                        <div className="col-span-4">Channel Rationale</div>
                                        <div className="col-span-2">Key Metric</div>
                                        <div className="col-span-1"></div>
                                    </div>
                                    
                                    {/* Table Rows */}
                                    {channels.map((channel, index) => (
                                        <div key={channel.id} className="grid grid-cols-12 gap-4 p-4 items-center channel-row border-b border-gray-100">
                                            {/* Channel Type */}
                                            <div className="col-span-2">
                                                <select
                                                    value={channel.channelType}
                                                    onChange={(e) => handleChannelUpdate(channel.id, 'channelType', e.target.value)}
                                                    className="w-full p-2.5 border border-gray-300 rounded-lg text-sm focus:border-blue-400 transition-colors appearance-none"
                                                >
                                                    <option value="">Select type</option>
                                                    <option value="Direct">Direct</option>
                                                    <option value="Partner">Partner</option>
                                                </select>
                                            </div>
                                            
                                            {/* Proposed Channel */}
                                            <div className="col-span-3">
                                                <input
                                                    type="text"
                                                    value={channel.channelName}
                                                    onChange={(e) => handleChannelUpdate(channel.id, 'channelName', e.target.value)}
                                                    placeholder="e.g., Content Marketing, Direct Sales"
                                                    className="w-full p-2.5 border border-gray-300 rounded-lg text-sm focus:border-blue-400 transition-colors"
                                                />
                                            </div>

                                            {/* Channel Rationale */}
                                            <div className="col-span-4">
                                                <textarea
                                                    value={channel.rationale}
                                                    onChange={(e) => handleChannelUpdate(channel.id, 'rationale', e.target.value)}
                                                    placeholder="Explain how this channel leverages a unique product capability to meet the buyer's needs..."
                                                    className="w-full p-2.5 border border-gray-300 rounded-lg text-sm focus:border-blue-400 transition-colors"
                                                    rows="2"
                                                />
                                            </div>

                                            {/* Key Metric - DISABLED */}
                                            <div className="col-span-2">
                                                <input
                                                    type="text"
                                                    value={channel.metric}
                                                    disabled
                                                    placeholder="Define in next step"
                                                    className="w-full p-2.5 border border-gray-200 rounded-lg text-sm bg-gray-50 text-gray-400 cursor-not-allowed"
                                                />
                                            </div>
                                            
                                            {/* Remove Button */}
                                            <div className="col-span-1 flex justify-center">
                                                <button
                                                    onClick={() => removeChannel(channel.id)}
                                                    className="p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors remove-button"
                                                    title="Remove Channel"
                                                    disabled={channels.length <= 1}
                                                >
                                                    <TrashIcon />
                                                </button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                            
                            {/* Add Channel Button */}
                            <div className="mt-6 flex justify-end">
                                <button
                                    onClick={addChannel}
                                    className="inline-flex items-center gap-2 px-5 py-2.5 bg-orange-500 text-white rounded-lg font-medium hover:bg-orange-600 transition-colors"
                                >
                                    <PlusCircleIcon />
                                    Add Channel Hypothesis
                                </button>
                            </div>
                        </div>

                    {/* Export Section */}
                    <div className="bg-gray-50 rounded-xl p-6 border border-gray-200">
                        <h3 className="text-lg font-semibold text-gray-800 mb-3">üìÑ Export Your Channel Strategy</h3>
                        <p className="text-sm text-gray-600 mb-4">
                            Copy your channel hypothesis matrix as formatted text for easy sharing.
                        </p>
                        
                        <button
                            onClick={handleCopyToClipboard}
                            className="bg-orange-500 text-white px-6 py-2.5 rounded-lg font-medium hover:bg-orange-600 transition-colors"
                        >
                            Copy to Clipboard
                        </button>
                        
                        <div id="copyStatus" className="mt-3"></div>
                        
                        {/* Hidden textarea for debugging */}
                        <textarea
                            id="markdownSummary"
                            readOnly
                            className="hidden"
                            value={generateMarkdownSummary()}
                        />
                    </div>

                    {/* Next Activity Prompt */}
                    <div className="mt-8 text-center">
                        <p className="text-gray-600 mb-4">
                            Ready to define success metrics for your channels?
                        </p>
                        <a 
                            href="channels-activity-3A.html"
                            className="inline-flex items-center gap-2 px-6 py-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors"
                        >
                            Continue to Activity 3 ‚Üí
                        </a>
                    </div>
                </div>
            );
        };

        // Render the app
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<ChannelHypothesisActivity />);
    </script>
</body>
</html>